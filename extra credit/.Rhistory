global_sharks %>%
filter(sex == "F" | sex == "M") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=age, y=n, fill=sex, group=sex))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=age, fill=sex, group=sex))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=sex, y=age, fill=sex, group=sex))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(year => 1950) %>%
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country="USA") %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5)
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5)
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area) %>%
count(area) %>%
arrange(desc(n)) %>%
head(n=5)
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area) %>%
count(area) %>%
arrange(desc(n)) %>%
head(n=5)
7. (3 points) In the United States, what are the top 5 states where shark attacks have been recorded since 1950? Make a plot that compares the number of incidents for these 5 states.
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area) %>%
count(area) %>%
arrange(desc(n))
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area) %>%
count(area) %>%
arrange(desc(n)) %>%
head(n=5)
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area) %>%
count(area) %>%
arrange(desc(n)) %>%
head(n=5) %>%
ggplot(aes(x=area, y = n,  fill=area))+
geom_col(alpha=0.6, color="grey43")+
labs(title="Total Number of Incidents by Sex",
y="# incidents")+
theme_light()
global_sharks %>%
filter(year >= 1950) %>%
mutate(year=as.factor(year)) %>%
filter(country=="USA") %>%
group_by(area) %>%
count(area) %>%
arrange(desc(n)) %>%
head(n=5) %>%
ggplot(aes(x=area, y = n,  fill=area))+
geom_col(alpha=0.6, color="grey43")+
labs(title="Top 5 States with Highest Total Number of Incidents Since 1950",
y="# incidents")+
theme_light()
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age of Individuals Attacked by Sharks by Sex",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(fatal_y_n == "Y") %>%
group_by(sex) %>%
count(sex) %>%
ggplot(aes(x=sex, y = n,  fill=sex))+
geom_col(alpha=0.6, color="grey43")+
labs(title="Total Number of Fatalities by Sex of Attached Individuals",
y="# incidents")+
theme_light()
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(fatal_y_n == "Y") %>%
group_by(sex) %>%
count(sex) %>%
ggplot(aes(x=sex, y = n,  fill=sex))+
geom_col(alpha=0.6, color="grey43")+
labs(title="Total Number of Fatalities by Sex of Attacked Individuals",
y="# incidents")+
theme_light()
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=sex, y=age, fill=sex))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=10) %>%
ggplot(aes(x=country, y = n,  fill=country))+
geom_col(alpha=0.6, color="grey43")+
labs(title="Total Number of Incidents by Country",
y="# incidents")+
coord_flip()+
theme_light()
white_sharks <- global_sharks %>%
str_detect("white sharks")
white_sharks <- global_sharks %>%
str_detect(species, "white sharks")
global_sharks[str_detect(global_sharks$species, "white sharks"), ]
global_sharks[str_detect(global_sharks$species, "white sharks"), ]
global_sharks[str_detect(global_sharks$species, "white sharks")]
global_sharks[str_detect(global_sharks$species, "white sharks")]
global_sharks[str_detect(global_sharks$species, "white sharks"),]
global_sharks[str_detect(global_sharks$species, "White sharks"),]
global_sharks %>%
filter(str_detect(`species`, pattern = c("White sharks")))
global_sharks %>%
filter(str_detect(`species`, pattern = c("White sharks", "White shark")))
global_sharks %>%
filter(str_detect(`species`, pattern = c("White sharks", "White shark")))
global_sharks %>%
mutate_all(tolower) %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
mutate_all(tolower) %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
mutate_all(tolower) %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
mutate(across(c("species"), tolower))
global_sharks %>%
mutate(across(c("species"), tolower)) %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
mutate("species", tolower)) %>%
global_sharks %>%
mutate("species", tolower) %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
mutate(tolower) %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
mutate("species", tolower) %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
filter(str_detect(`species`, pattern = c("white sharks")))
global_sharks %>%
filter(str_detect(`species`, pattern = c("white sharks", "White sharks")))
global_sharks %>%
filter(str_detect(`species`, pattern = c("white sharks", "White sharks", "White Sharks")))
global_sharks %>%
filter(str_detect(`species`, pattern = c("white sharks|white Shark")))
filter(str_detect(`species`, pattern = c("white sharks|white Shark"))
global_sharks %>%
filter(str_detect(`species`, pattern = ("white sharks|white Shark"))_
filter(str_detect(`species`, pattern = ("white sharks|white Shark"))
global_sharks %>%
global_sharks %>%
filter(str_detect(`species`, pattern = ("white sharks|white Shark")))
global_sharks %>%
filter(str_detect(`species`, pattern = ("white sharks|white shark")))
global_sharks %>%
filter(str_detect(`species`, pattern = ("white sharks|white shark|White shark")))
global_sharks %>%
filter(str_detect(`species`, pattern = ("white sharks|white shark|White shark")))
global_sharks %>%
filter(str_detect("species", pattern = ("white sharks|white shark|White shark")))
global_sharks %>%
filter(str_detect(`species`, pattern = ("white sharks|white shark|White shark")))
global_sharks %>%
filter(str_detect(species, pattern = ("white sharks|white shark|White shark")))
`
`
global_sharks %>%
filter(str_detect(`species`, pattern = ("white sharks|white shark|White shark")))
global_sharks %>%
filter(str_detect(species, pattern = ("white sharks|white shark|White shark")))
global_sharks %>%
filter(str_detect(species, pattern = ("white sharks|white shark|White shark|White Shark")))
global_sharks %>%
filter(str_detect(species, pattern = ("white sharks|white shark|White shark|White Shark|Whit Sharks")))
global_sharks %>%
filter(str_detect(species, pattern = ("white sharks|white shark|White shark|White Shark|White Sharks")))
global_sharks %>%
filter(str_detect(species, pattern = ("white shark|White shark|White Shark")))
global_sharks %>%
filter(str_detect(species, pattern = ("white shark|White shark|White Shark|white Shark")))
global_sharks %>%
filter(str_detect(species, pattern = ("white shark|White shark|White Shark")))
global_sharks %>%
filter(str_detect(species, pattern = ("white|White")))
global_sharks %>%
filter(str_detect(species, pattern = ("White")))
global_sharks %>%
filter(str_detect(species, pattern = ("White")))
white_sharks <- global_sharks %>%
filter(str_detect(species, pattern = ("White"))) %>%
```
white_sharks <- global_sharks %>%
filter(str_detect(species, pattern = ("White")))
white_sharks %>%
group_by(country) %>%
count(county) %>%
arrange(desc(n))
View(white_sharks)
white_sharks %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n))
white_sharks %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5) %>%
filter(fatal_y_n="Y" | fatal_y_n="N") %>%
white_sharks %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5) %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number and Types of Injuries by Activity",
y="Types of injury")
white_sharks %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5) %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number and Types of Injuries by Activity",
y="Types of injury")
white_sharks %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5) %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N")
white_sharks %>%
group_by(country) %>%
count(country) %>%
arrange(desc(n)) %>%
head(n=5)
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number and Types of Injuries by Activity",
y="Types of injury")
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill=fatal_y_n , alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number and Types of Injuries by Activity",
y="Types of injury")
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill=fatal_y_n , alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number and Types of Injuries by Activity",
y="Types of injury")
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number and Types of Injuries by Activity",
y="Types of injury")
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Fatal and Non-Fatal Attacks for Top 5 Countries with White Shark Attacks",
y="# Injury",
x="Fatality (Y or N")
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Fatal and Non-Fatal Attacks for Top 5 Countries with White Shark Attacks",
y="# Injury",
x="Fatality (Y or N)")
white_sharks %>%
filter(country=="USA" | country=="AUSTRALIA"|country=="SOUTH AFRICA"|country=="NEW ZEALAND"|country=="ITALY") %>%
filter(fatal_y_n=="Y" | fatal_y_n=="N") %>%
ggplot(aes(x=fatal_y_n))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~country)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Fatal and Non-Fatal Attacks for Top 5 Countries with White Shark Attacks",
y="# Injury",
x="Fatal (Y or N)")
View(global_sharks)
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
ggplot(aes(x=sex, y=type, fill=sex))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
ggplot(aes(x=sex, y=type, fill=sex))+
geom_bar(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
ggplot(aes(x=sex, y=type, fill=sex))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
ggplot(aes(y=sex, x=type, fill=sex))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(type == "Unprovoked"| type=="Unprovoked") %>%
ggplot(aes(y=sex, x=type, fill=sex))+
geom_bar(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(type == "Unprovoked"| type=="Unprovoked") %>%
ggplot(aes(y=sex, x=type, fill=sex))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(type == "Unprovoked"| type=="provoked") %>%
ggplot(aes(y=sex, x=type, fill=sex))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(type == "Unprovoked"| type=="provoked") %>%
ggplot(aes(y=sex, x=type, fill=sex))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(type == "Unprovoked"| type=="provoked") %>%
ggplot(aes(y=sex, x=type, fill=sex))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(type == "Unprovoked"| type=="Provoked") %>%
ggplot(aes(y=sex, x=type, fill=sex))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(sex == "F" | sex == "M") %>%
filter(type == "Unprovoked"| type=="Provoked") %>%
ggplot(aes(y=sex, x=type))+
geom_col(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(type == "Unprovoked"| type=="Provoked") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=type, y=age, fill=type))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Age (years)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(type == "Unprovoked"| type=="Provoked") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=type, y=age, fill=type))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age by Sex of Individuals Attacked by Sharks",
x="Type")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(type == "Unprovoked"| type=="Provoked") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=type, y=age, fill=type))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age of Individuals Attacked by Sharks by Provocation",
x="Type")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(type == "Unprovoked"| type=="Provoked") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=type, y=age, fill=type))+
geom_density(alpha=0.6, color = "grey43")+
labs(title="Distribution of Age of Individuals Attacked by Sharks by Provocation",
x="Type")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
global_sharks %>%
filter(type == "Unprovoked"| type=="Provoked") %>%
mutate(age = as.integer(age)) %>%
filter(age != "NA") %>%
ggplot(aes(x=type, y=age, fill=type))+
geom_boxplot(alpha=0.6, color = "grey43")+
labs(title="Range of Age of Individuals Attacked by Sharks by Provocation",
x="Type")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
