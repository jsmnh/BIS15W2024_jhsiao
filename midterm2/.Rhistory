white_sharks %>%
filter(sex!="NA") %>%
ggplot(aes(x=total_length_cm, fill=sex, group=sex))+
geom_density(alpha=0.6, color = "grey43")+
labs(title="Range of Total Length by Sex of White Sharks",
x="Total Length (cm)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
summary(sharks)
glimpse(sharks)
sharks %>%
naniar::miss_var_summary()
sharks <- sharks %>%
replace_with_na(replace = list(incident_num = "NOT COUNTED",
time="Unknown")) %>%
filter(incident_num != "NA")
sharks %>%
ggplot(aes(x=county, fill=county))+
geom_bar(alpha=0.6, color="grey43")+
labs(title="Total Number of Incidents per County",
y="# incidents")+
coord_flip()+
theme_light()
sharks %>%
mutate(month = as.factor(month)) %>%
ggplot(aes(x=month, fill=month))+
geom_bar(alpha=0.6, color="grey43")+
labs(title="Total Number of Incidents per Month",
y="# incidents")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))+
theme_light()
sharks %>%
group_by(county) %>%
count(injury) %>%
arrange(desc(n))
sharks %>%
group_by(county) %>%
count(injury) %>%
filter(injury=="fatal") %>%
arrange(desc(n))
sharks %>%
tabyl(county, injury)
sharks %>%
group_by(mode) %>%
count(mode) %>%
arrange(desc(n))
sharks %>%
ggplot(aes(x=injury))+
geom_bar(fill="deepskyblue4", alpha=0.7)+
facet_wrap(~mode)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number and Types of Injuries by Activity",
y="Types of injury")
sharks %>%
group_by(species) %>%
count(species) %>%
arrange(desc(n))
sharks %>%
filter(species == "White") %>%
ggplot(aes(x=injury))+
geom_bar(position="dodge", fill="royalblue4", alpha=0.9)+
labs(title="Number of Injuries for Great White",
x="Types of Injuries",
y="# Injuries")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
white_sharks <- read_csv("data/White sharks tracked from Southeast Farallon Island, CA, USA, 1999 2004.csv", na = c("?", "n/a")) %>% clean_names()
summary(white_sharks)
white_sharks %>%
naniar::miss_var_summary()
white_sharks %>%
filter(sex != "NA") %>%
tabyl(sex, total_length_cm)
white_sharks %>%
filter(sex != "NA") %>%
group_by(sex) %>%
count(total_length_cm) %>%
arrange(desc(total_length_cm))
white_sharks %>%
filter(sex!="NA") %>%
ggplot(aes(x=total_length_cm, fill=sex, group=sex))+
geom_density(alpha=0.6, color = "grey43")+
labs(title="Range of Total Length by Sex of White Sharks",
x="Total Length (cm)")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
white_sharks %>%
filter(maturity!="NA" ) %>%
ggplot(aes(x=maturity, y=total_length_cm, fill=maturity))+
geom_boxplot(alpha=0.6,  color = "grey43", na.rm=T)+
labs(title="Range of Total Length by Maturity of White Sharks",
x="Total Length (cm)",
y="Maturity")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
