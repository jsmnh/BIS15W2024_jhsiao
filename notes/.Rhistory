group_by(order) %>%
summarize(mean_mass = mean(mass, na.rm=T)) %>%
ggplot(aes(x=order, y=mean_mass))+
geom_col()+
coord_flip()
options(scipen=999)#cancels scientific notation for the session
life_history %>%
group_by(order) %>%
summarize(mean_mass = mean(mass, na.rm=T)) %>%
ggplot(aes(x=order, y=mean_mass))+
geom_col()+
coord_flip()+
scale_y_log10()
life_history %>%
group_by(order) %>%
summarize(mean_mass = mean(mass, na.rm=T)) %>%
ggplot(aes(x=reorder(order, mean_mass), y=mean_mass))+ # This allows us to order the x-axis by mean_mass
geom_col()+
coord_flip()+
scale_y_log10()
life_history %>%
ggplot(aes(x=gestation, y=wean_mass))+
geom_jitter(na.rm = T)+ # prevents overplotting
scale_y_log10()
life_history %>%
ggplot(aes(x=order, y=mass))+
geom_boxplot(na.rm = T)+
coord_flip()+
scale_y_log10()
elephants <- read_csv("data_midterm2/elephantsMF.csv") %>% clean_names()
elephants %>%
ggplot(aes(x=age, y=height))+
geom_point()+
geom_smooth(method = lm, sex = F)
elephants %>%
ggplot(aes(x=age, y=height)) +
geom_point() +
geom_smooth(method=lm, se=F)+
labs(title="Elephant Age vs. Height", # adds a title
x="Age (years)",
y="Height (cm)")
elephants %>%
ggplot(aes(x=age, y=height)) +
geom_point() +
geom_smooth(method=lm, se=F)+ # se = standard error along with line
labs(title="Elephant Age vs. Height", # adds a title
x="Age (years)",
y="Height (cm)")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5)) # rel = title relative to the plot, hjust = horizontal (left = 0, right = 1)
elephants %>%
ggplot(aes(x=sex, fill=sex))+ #fill is a grouping option
geom_bar()
life_history %>%
ggplot(aes(x=gestation, y=log10(mass), size=mass))+ # Made size relative to mass of thing plotted
geom_point(na.rm=T)
homerange <-
read_csv("data_midterm2/Tamburelloetal_HomeRangeDatabase.csv", na = c("", "NA", "\\"))
p <- homerange %>%
ggplot(aes(x= log10.mass, y= log10.hra)) # store base plot as object
p + geom_point(size=1.25)
p + geom_point(aes(color=thermoregulation), size=1.5) # For scatterplots, "color" is the same as "fill" in barplots
p + geom_point(aes(color=thermoregulation, shape=thermoregulation), size=1.5)
homerange %>% count(taxon, sort=T)
homerange %>%
ggplot(aes(x=taxon))+
geom_bar()+
coord_flip()+
labs(title="Observations by Taxon",
x="Taxonomic Group")
homerange %>%
ggplot(aes(x=taxon, fill=trophic.guild))+
geom_bar()+
coord_flip()+
labs(title="Observations by Taxon",
x="Taxonomic Group")
homerange %>%
ggplot(aes(x=taxon, fill=trophic.guild))+
geom_bar(position="dodge")+
coord_flip()+
labs(title="Observations by Taxon",
x="Taxonomic Group")
homerange %>%
ggplot(aes(x=taxon, fill=trophic.guild))+
geom_bar(position="dodge")+
theme(axis.text.x=element_text(angle=60, hjust = 1))+ #change angle of x-axis observations
labs(title="Observations by Taxon",
x="Taxonomic Group")
homerange %>%
ggplot(aes(x = taxon, fill = trophic.guild))+
geom_bar(position = position_fill())+
scale_y_continuous(labels = scales::percent)+
coord_flip()
homerange %>%
ggplot(aes(x = class, y = log10.mass)) +
geom_boxplot()
homerange %>%
ggplot(aes(x = class, y = log10.mass, group = taxon)) +
geom_boxplot()
homerange %>%
ggplot(aes(x = class, y = log10.mass, fill = taxon)) +
geom_boxplot(alpha=0.5)
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
options(scipen=999) #cancels the use of scientific notation for the session
deserts <- read_csv("data_midterm2/surveys_complete.csv")
deserts %>%
filter(species_id=="DM" | species_id == "DS") %>%
mutate(year=as.factor(year)) %>%  # Change to factor bc R would think you're doing a numeric (addition etc.) but you dont add years
group_by(year, species_id) %>%
summarize(n=n(), .groups = 'keep') %>%
pivot_wider(names_from = species_id, values_from = n)
deserts %>%
filter(species_id=="DM" | species_id == "DS") %>%
mutate(year=as.factor(year)) %>% # If you remove this gaps would be big and treated as numeric
group_by(year, species_id) %>%
summarize(n=n(), .groups = 'keep') %>%
ggplot(aes(x=year, y=n, group=species_id, color = species_id))+
geom_line()+
geom_point(shape=2)+ # You can experiment with shapes
theme(axis.text.x=element_text(angle=60, hjust=1))+
labs(title="Number of Samples for Species DM & DS",
x = "Year",
y = "n")
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(bins = 30)+ #we can adjust the number of bins with the bins argument
labs(title = "Distribution of Body Mass")
#grDevices::colors()
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(color = "black", fill = "powderblue", bins=10)+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_density(fill="deepskyblue4", alpha  =0.4, color = "black")+ #alpha is the transparency
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_histogram(aes(y = after_stat(density)), fill = "deepskyblue4", alpha = 0.4, color = "black")+
geom_density(color = "red")+
labs(title = "Distribution of Body Mass")
glimpse(homerange)
homerange %>%
select(log10.mass) %>%
summarize(min=min(log10.mass),
max=max(log10.mass))
summary(homerange$log10.mass)
homerange %>%
mutate(mass_category=case_when(log10.mass<=1.75 ~ "small",
log10.mass>1.75 & log10.mass <= 2.75 ~ "medium",
log10.mass>2.75 ~ "large"))
homerange %>%
mutate(mass_category=case_when(log10.mass<=1.75 ~ "small",
log10.mass>1.75 & log10.mass <= 2.75 ~ "medium",
log10.mass>2.75 ~ "large")) %>%
ggplot(aes(x=mass_category, fill=trophic.guild))+
geom_bar(position="dodge")
summary(homerange$log10.hra)
library(gtools)
#install.packages("gtools")
quartiles <- quantcut(homerange$log10.hra)
table(quartiles)
homerange %>%
mutate(range_category=case_when(log10.hra<3.65 ~ "very small",
log10.hra>=3.65 & log10.hra<=4.59 ~ "small",
log10.hra>=4.59 & log10.hra<=6.02 ~ "medium",
log10.hra>=6.02 ~ "large"))
homerange %>%
mutate(range_category=case_when(log10.hra<3.65 ~ "very small",
log10.hra>=3.65 & log10.hra<=4.59 ~ "small",
log10.hra>=4.59 & log10.hra<=6.02 ~ "medium",
log10.hra>=6.02 ~ "large")) %>%
ggplot(aes(x=range_category, fill=class))+
geom_bar(position = "dodge", alpha=0.6, color = "black")
homerange %>%
mutate(range_category=case_when(log10.hra<3.65 ~ "very small",
log10.hra>=3.65 & log10.hra<=4.59 ~ "small",
log10.hra>=4.59 & log10.hra<=6.02 ~ "medium",
log10.hra>=6.02 ~ "large")) %>%
filter(range_category=="small") %>%
ggplot(aes(x=class, y=log10.mass, fill=class))+
geom_boxplot()
p <- homerange %>%
ggplot(aes(x=taxon, fill=trophic.guild))+
geom_bar(na.rm=T, position="dodge")
p + theme_linedraw()+
theme(axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
p+theme_linedraw()+
theme(legend.position = "top",
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL, # removes the label from the x axis
y= "n",
fill= "Trophic Guild")
#install.packages("ggthemes")
library(ggthemes)
#ls("package:ggthemes")[grepl("theme_", ls("package:ggthemes"))]
p +
theme_fivethirtyeight()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
?RColorBrewer
display.brewer.pal(5,"YlGnBu") #sequential palette
p+scale_fill_brewer(palette = "Paired")+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
colors <- paletteer::palettes_d_names
my_palette <- paletteer_d("futurevisions::atomic_orange") #Store your palette
barplot(rep(1,6), axes=FALSE, col=my_palette) # Show your palette
p+scale_fill_manual(values=my_palette)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust=1))
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
facet_wrap(~trophic.guild)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
facet_grid(trophic.guild~.)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
facet_grid(trophic.guild~thermoregulation)+
theme(axis.text.x = element_text(angle = 60, hjust=1))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
library(naniar)
library(ggthemes)
library(RColorBrewer)
options(scipen = 999)
#install.packages("gapminder")
library("gapminder")
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("janitor")
library("naniar")
surgery <- read_csv("data/surgery.csv")
summary(surgery)
glimpse(surgery)
surgery %>%
map_df(~ sum(is.na(.)))
surgery %>% naniar::miss_var_summary()
surgery %>%
count(race)
surgery %>%
ggplot(aes(x=race, fill=race))+
geom_bar(alpha=0.6, color="black")+ # Alpha is for transparency
labs(title="Number of Participants by Race",
y="# participants")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
surgery %>%
filter(gender != "NA") %>%
group_by(gender) %>%
summarize(mean_age = mean(age, na.rm=T))
surgery %>%
filter(gender != "NA") %>%
group_by(gender) %>%
ggplot(aes(x=gender, y = age, fill=gender))+
geom_boxplot(na.rm=T, alpha=0.6)+
labs(title="Range of Age Associated with Gender",
x=NULL,
y="Age (years)")+
theme_light()+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
surgery %>%
filter(asa_status!="NA") %>%
ggplot(aes(x=asa_status, fill = asa_status))+
geom_bar(color="black", alpha=0.6)+
labs(title="Number of Patient Physical Status",
x="ASA",
y="# Participants")+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
surgery %>%
ggplot(aes(x = bmi)) +
geom_density(color = "gray43", fill = "powderblue", alpha=0.6, na.rm=T)+
facet_wrap(~asa_status)+
labs(title= "Distribution of Body Mass Index",
x="BMI",
y=NULL)+
theme(plot.title=element_text(size=rel(1.5), hjust = 0.5))
surgery %>%
group_by(ahrq_ccs) %>%
summarize(ccsmort30rate=mean(ccsmort30rate)) %>%
arrange(desc(ccsmort30rate))%>%
slice_max(ccsmort30rate, n=5)
surgery %>%
group_by(ahrq_ccs) %>%
summarize(ccscomplicationrate=mean(ccscomplicationrate)) %>%
arrange(desc(ccscomplicationrate)) %>%
slice_max(ccscomplicationrate, n=5)
surgery %>%
select(ahrq_ccs, ccsmort30rate, ccscomplicationrate) %>%
filter(ahrq_ccs %in% c("Colorectal resection", "Small bowel resection", "Gastrectomy; partial and total", "Endoscopy and endoscopic biopsy of the urinary tract", "Spinal fusion", "Nephrectomy; partial or complete")) %>%
group_by(ahrq_ccs) %>%
summarise(ccsmort30rate=mean(ccsmort30rate),
ccscomplicationrate=mean(ccscomplicationrate))
surgery %>%
ggplot(aes(x=ahrq_ccs, y=ccsmort30rate, group=ahrq_ccs))+
geom_col(position="dodge", fill="royalblue4", alpha=0.4)+
coord_flip()+
labs(title="30-day Mortality vs Procedures",
x=NULL,
y="Rate")+
theme_light()
surgery_new <- surgery %>%
mutate(mort30_n = ifelse(mort30=="Yes", 1, 0),
complication_n = ifelse(complication=="Yes", 1, 0)) %>%
group_by(month) %>%
summarize(n_death=sum(mort30_n),
n_comp=sum(complication_n))
surgery %>%
tabyl(month, mort30)
surgery %>%
tabyl(month, complication)
surgery_new %>%
ggplot(aes(x=month, y=n_death))+
geom_col(alpha=0.8, fill="slateblue3", color="black")+
labs(title="30-Day Mortality by Month",
x=NULL,
y="Rate")+
scale_x_discrete(limits=c("Jan","Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))+
theme_light()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
library(naniar)
library(ggthemes)
library(RColorBrewer)
options(scipen = 999)
#install.packages("gapminder")
library("gapminder")
summary(gapminder)
glimpse(gapminder)
names(gapminder)
anyNA(gapminder)
ls("package:ggthemes")[grepl("theme_", ls("package:ggthemes"))]
gapminder %>%
filter(lifeExp>=1952 | lifeExp<=2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x=year, y=lifeExp))+
geom_boxplot()+
labs(title = "Global Life Expectancy Between 1952 to 2007")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
filter(lifeExp>=1952 | lifeExp<=2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x = lifeExp)) +
geom_density(fill="darkseagreen3", alpha =0.4, color = "darkgrey")+
labs(title = "Distribution of Life Expectancy")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
group_by(continent) %>%
summarize(min_life_exp=min(lifeExp),
mean_life_exp=mean(lifeExp),
max_life_exp=max(lifeExp))
gapminder %>%
filter(lifeExp>=1952 | lifeExp<=2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x=year, y=lifeExp))+
geom_boxplot()+
facet_grid(continent~.)+
labs(title = "Life Expectancy Between 1952-2007 for each Continent")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
ggplot(aes(x=log10(gdpPercap), y= lifeExp))+
geom_point(na.rm = T)+
geom_smooth(method=lm, se = T)+
labs(title="Log of Per Capita GDP vs Life Expectancy")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
mutate(year=as.factor(year)) %>%
filter(year==1952 | year==2007) %>%
select(country, year, pop) %>%
pivot_wider(names_from = "year",
values_from = "pop",
names_prefix = "pop_") %>%
mutate(pop_growth = pop_2007-pop_1952) %>%
arrange(desc(pop_growth)) %>%
head(n=5)
gapminder
gapminder %>%
mutate(year=as.factor(year)) %>%
filter(country == "China" | country == "India" | country == "United States" | country == "Indonesia" | country == "Brazil") %>%
ggplot(aes(x=year, y=pop, color = country, group = country))+
geom_line(na.rm = T)+
labs(title="Population Growth Since 1952 for Top 5 Countries")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))+
theme_linedraw()
gapminder %>%
mutate(year=as.factor(year)) %>%
filter(country == "China" | country == "India" | country == "United States" | country == "Indonesia" | country == "Brazil") %>%
ggplot(aes(x=year, y=gdpPercap, color = country, group=country))+
geom_line(na.rm = T)+
labs(title="Per Capita GDP Growth for Top 5 Countries")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
mutate(year=as.factor(year)) %>%
filter(continent=="Oceania") %>%
ggplot(aes(x=year, y=pop, group=country))+
geom_line()+
facet_grid(country~.)+
labs(title = "Population Between 1952-2007 for Oceania Countries")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
```{r}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
library(naniar)
library(ggthemes)
library(RColorBrewer)
options(scipen = 999)
#install.packages("gapminder")
library("gapminder")
summary(gapminder)
glimpse(gapminder)
names(gapminder)
anyNA(gapminder)
ls("package:ggthemes")[grepl("theme_", ls("package:ggthemes"))]
gapminder %>%
filter(lifeExp>=1952 | lifeExp<=2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x=year, y=lifeExp))+
geom_boxplot()+
labs(title = "Global Life Expectancy Between 1952 to 2007")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
filter(lifeExp>=1952 | lifeExp<=2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x = lifeExp)) +
geom_density(fill="darkseagreen3", alpha =0.4, color = "darkgrey")+
labs(title = "Distribution of Life Expectancy")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
group_by(continent) %>%
summarize(min_life_exp=min(lifeExp),
mean_life_exp=mean(lifeExp),
max_life_exp=max(lifeExp))
gapminder %>%
filter(lifeExp>=1952 | lifeExp<=2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x=year, y=lifeExp))+
geom_boxplot()+
facet_grid(continent~.)+
labs(title = "Life Expectancy Between 1952-2007 for each Continent")+
theme(plot.title=element_text(size=rel(1), hjust = 0.5))
gapminder %>%
filter(year==1952 | year==2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x=lifeExp, group=year, fill=year))+
geom_density(alpha=0.5)
```{r}
gapminder %>%
group_by(year) %>%
summarize(min=min(lifeExp),
mean=mean(lifeExp),
max=max(lifeExp))
gapminder %>%
group_by(year) %>%
summarize(mean=mean(lifeExp)) %>%
ggplot(aes(x=year, y=mean))+
geom_line()
**5. How has life expectancy changed between 1952-2007 for each continent?**
**5. How has life expectancy changed between 1952-2007 for each continent?**
gapminder %>%
group_by(year, continent) %>%
summarize(mean=mean(lifeExp)) %>%
ggplot(aes(x=year, y=mean, group=continent, color=continent))+
geom_line()
**3. How do the distributions of life expectancy compare for the years 1952 and 2007?**
gapminder %>%
filter(year==1952 | year==2007) %>%
mutate(year=as.factor(year)) %>%
ggplot(aes(x=lifeExp, group=year, fill=year))+
geom_density(alpha=0.5)
**6. We are interested in the relationship between per capita GDP and life expectancy; i.e. does having more money help you live longer?**
gapminder %>%
ggplot(aes(x=gdpPercap, y=lifeExp))+
geom_point()+
scale_x_log10()+
geom_smooth(method=lm, se=F)+
labs(title = "GDP vs. Life Expectancy",
x = "GDP per capita (log 10)",
y = "Life expectancy")
